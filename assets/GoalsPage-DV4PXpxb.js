import{r as u,j as e}from"./index-CNoY_Her.js";import{u as D}from"./store-CUCRhUuB.js";import{b as M,u as R,R as T}from"./goalStore-cgZeyM2Y.js";function I({goalId:x,pageSize:m=5}){const h=D(n=>n.contributions.filter(g=>g.goalId===x)),p=u.useMemo(()=>M(h),[h]),i=Math.max(1,Math.ceil(p.length/m)),[r,d]=u.useState(0),b=r*m,c=p.slice(b,b+m);return p.length===0?e.jsx("div",{className:"rounded-xl border border-slate-800/60 bg-slate-900/40 p-4 text-sm text-slate-400",children:"No contributions yet. Add your first contribution to start tracking progress."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("ul",{className:"space-y-2 text-sm text-slate-100",children:c.map(n=>e.jsxs("li",{className:"flex items-center justify-between rounded-lg border border-slate-800/60 bg-slate-900/40 px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:n.amount.toLocaleString(void 0,{style:"currency",currency:"USD"})}),e.jsx("p",{className:"text-xs text-slate-400",children:n.date})]}),n.note&&e.jsx("p",{className:"text-xs text-slate-400",children:n.note})]},n.id))}),i>1&&e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[e.jsx("button",{type:"button",disabled:r===0,onClick:()=>d(n=>Math.max(0,n-1)),className:"rounded border border-slate-700 px-3 py-1 disabled:opacity-40",children:"Previous"}),e.jsxs("span",{children:["Page ",r+1," of ",i]}),e.jsx("button",{type:"button",disabled:r+1>=i,onClick:()=>d(n=>Math.min(i-1,n+1)),className:"rounded border border-slate-700 px-3 py-1 disabled:opacity-40",children:"Next"})]})]})}const C={name:"",targetAmount:"",targetDate:"",description:""},y=()=>({amount:"",date:new Date().toISOString().slice(0,10),note:""});function U(){var w;const x=D(t=>t.goals),{createGoal:m,updateGoal:h,addContribution:p,resetGoal:i}=R(),[r,d]=u.useState(C),[b,c]=u.useState({}),[n,g]=u.useState(null),[f,j]=u.useState(null),S=t=>{if(t.preventDefault(),!r.name.trim())return;const s=Number(r.targetAmount);s>0&&(m({name:r.name.trim(),targetAmount:s,targetDate:r.targetDate||void 0,description:r.description.trim()||void 0}),d(C))},k=(t,s)=>{s.preventDefault();const l=new FormData(s.currentTarget),a=Number(l.get("targetAmount"));a>0&&(h(t,{name:String(l.get("name")).trim(),targetAmount:a,targetDate:String(l.get("targetDate"))||void 0,description:String(l.get("description")).trim()||void 0}),g(null))},A=(t,s)=>{s.preventDefault();const l=b[t]??y(),a=Number(l.amount);a>0&&(p(t,{amount:a,date:l.date,note:l.note.trim()||void 0}),c(o=>({...o,[t]:{...y(),note:""}})))},G=t=>{f&&(i(f,{reason:t}),j(null))},N=x.filter(t=>t.status==="active"),v=x.filter(t=>t.status==="archived");return e.jsxs("section",{className:"space-y-8",children:[e.jsxs("header",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-semibold text-slate-50",children:"Savings Goals"}),e.jsx("p",{className:"max-w-2xl text-sm text-slate-400",children:"Visualize long-term objectives, add contributions, and reset plans when strategies change."})]}),e.jsxs("form",{onSubmit:S,className:"grid gap-4 rounded-2xl border border-slate-800/70 bg-slate-900/40 p-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-widest text-slate-400",children:"Goal name"}),e.jsx("input",{required:!0,value:r.name,onChange:t=>d(s=>({...s,name:t.target.value})),className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none",placeholder:"e.g., Emergency fund"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-widest text-slate-400",children:"Target amount"}),e.jsx("input",{required:!0,type:"number",min:"1",step:"0.01",value:r.targetAmount,onChange:t=>d(s=>({...s,targetAmount:t.target.value})),className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-widest text-slate-400",children:"Target date"}),e.jsx("input",{type:"date",value:r.targetDate,onChange:t=>d(s=>({...s,targetDate:t.target.value})),className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-widest text-slate-400",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:t=>d(s=>({...s,description:t.target.value})),className:"min-h-[72px] w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none",placeholder:"Optional context"})]}),e.jsx("div",{className:"md:col-span-2 flex justify-end",children:e.jsx("button",{type:"submit",className:"rounded-lg bg-brand-secondary px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-brand-secondary/30 transition hover:translate-y-0.5",children:"Create goal"})})]}),e.jsxs("section",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200",children:"Active goals"}),N.length===0&&e.jsx("p",{className:"rounded-xl border border-dashed border-slate-700 bg-slate-900/40 p-6 text-sm text-slate-400",children:"Create your first savings goal to begin tracking progress."}),e.jsx("div",{className:"dashboard-cards grid gap-6 xl:grid-cols-2",children:N.map(t=>{const s=b[t.id]??y(),l=Math.max(0,t.targetAmount-t.progress.totalContributed);return e.jsxs("article",{className:"flex flex-col gap-4 rounded-2xl border border-slate-800/70 bg-slate-900/50 p-6",children:[e.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-semibold text-slate-100",children:t.name}),e.jsxs("p",{className:"text-xs uppercase tracking-widest text-slate-500",children:["Target ",t.targetAmount.toLocaleString(void 0,{style:"currency",currency:"USD"})]})]}),e.jsx("button",{type:"button",onClick:()=>g(a=>a===t.id?null:t.id),className:"rounded border border-slate-600 px-3 py-1 text-xs font-semibold text-slate-200 hover:bg-slate-800",children:n===t.id?"Cancel edit":"Edit goal"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-2 w-full rounded-full bg-slate-800",children:e.jsx("div",{className:"h-full rounded-full bg-brand-primary",style:{width:`${t.progress.percentage}%`}})}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-300",children:[e.jsxs("span",{children:["Contributed"," ",e.jsx("strong",{className:"text-slate-100",children:t.progress.totalContributed.toLocaleString(void 0,{style:"currency",currency:"USD"})})]}),e.jsxs("span",{children:["Remaining"," ",e.jsx("strong",{className:"text-slate-100",children:l.toLocaleString(void 0,{style:"currency",currency:"USD"})})]}),e.jsxs("span",{children:["Progress ",e.jsxs("strong",{className:"text-slate-100",children:[t.progress.percentage,"%"]})]})]})]}),n===t.id&&e.jsxs("form",{onSubmit:a=>k(t.id,a),className:"grid gap-3 rounded-xl border border-slate-800/60 bg-slate-900/40 p-4 text-sm",children:[e.jsxs("label",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs uppercase tracking-[0.25em] text-slate-500",children:"Name"}),e.jsx("input",{name:"name",defaultValue:t.name,className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none"})]}),e.jsxs("label",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs uppercase tracking-[0.25em] text-slate-500",children:"Target amount"}),e.jsx("input",{name:"targetAmount",type:"number",min:"1",step:"0.01",defaultValue:t.targetAmount,className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none"})]}),e.jsxs("label",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs uppercase tracking-[0.25em] text-slate-500",children:"Target date"}),e.jsx("input",{name:"targetDate",type:"date",defaultValue:t.targetDate??"",className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none"})]}),e.jsxs("label",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs uppercase tracking-[0.25em] text-slate-500",children:"Description"}),e.jsx("textarea",{name:"description",defaultValue:t.description??"",className:"min-h-[64px] w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>g(null),className:"rounded border border-slate-600 px-3 py-1 text-xs font-semibold text-slate-200 hover:bg-slate-800",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded bg-brand-primary px-3 py-1 text-xs font-semibold text-white shadow shadow-brand-primary/40",children:"Save changes"})]})]}),e.jsxs("form",{onSubmit:a=>A(t.id,a),className:"grid gap-3 rounded-xl border border-slate-800/60 bg-slate-900/40 p-4 text-sm",children:[e.jsxs("div",{className:"grid gap-3 lg:grid-cols-3",children:[e.jsxs("label",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs uppercase tracking-[0.25em] text-slate-500",children:"Amount"}),e.jsx("input",{type:"number",min:"1",step:"0.01",value:s.amount,onChange:a=>c(o=>({...o,[t.id]:{...s,amount:a.target.value}})),className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none",required:!0})]}),e.jsxs("label",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs uppercase tracking-[0.25em] text-slate-500",children:"Date"}),e.jsx("input",{type:"date",value:s.date,onChange:a=>c(o=>({...o,[t.id]:{...s,date:a.target.value}})),className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none",required:!0})]}),e.jsxs("label",{className:"space-y-1 lg:col-span-1",children:[e.jsx("span",{className:"text-xs uppercase tracking-[0.25em] text-slate-500",children:"Note"}),e.jsx("input",{value:s.note,onChange:a=>c(o=>({...o,[t.id]:{...s,note:a.target.value}})),className:"w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none",placeholder:"Optional context"})]})]}),e.jsxs("div",{className:"flex justify-between gap-3",children:[e.jsx("button",{type:"button",onClick:()=>j(t.id),className:"rounded border border-rose-400 px-3 py-2 text-xs font-semibold text-rose-200 hover:bg-rose-500/20",children:"Reset contributions"}),e.jsx("button",{type:"submit",className:"rounded bg-brand-secondary px-4 py-2 text-xs font-semibold text-white shadow shadow-brand-secondary/40",children:"Add contribution"})]})]}),e.jsx(I,{goalId:t.id})]},t.id)})})]}),v.length>0&&e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200",children:"Archived goals"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:v.map(t=>e.jsxs("div",{className:"rounded-xl border border-slate-800/60 bg-slate-900/40 p-4 text-sm text-slate-300",children:[e.jsx("h4",{className:"font-semibold text-slate-100",children:t.name}),e.jsxs("p",{children:["Completed ",t.progress.totalContributed.toLocaleString(void 0,{style:"currency",currency:"USD"})]}),t.resetAt&&e.jsxs("p",{className:"text-xs text-slate-500",children:["Last reset ",t.resetAt]})]},t.id))})]}),e.jsx(T,{open:f!==null,goalName:((w=x.find(t=>t.id===f))==null?void 0:w.name)??"",onConfirm:G,onCancel:()=>j(null)})]})}export{U as default};
