import{r as c,j as s}from"./index-CNoY_Her.js";import{u as l}from"./store-CUCRhUuB.js";const m=()=>{const t=new Date().toISOString();return{id:"singleton",theme:"system",defaultRange:"currentMonth",seenOnboarding:!1,chartStyle:"donut",createdAt:t,updatedAt:t}};function y(){const t=l.getState(),e=t.preferences??m();return{transactions:t.transactions,categories:t.categories,goals:t.goals,contributions:t.contributions,preferences:e,auditLog:t.auditLog}}function S(t){l.setState(e=>({transactions:t.transactions??e.transactions,categories:t.categories??e.categories,goals:t.goals??e.goals,contributions:t.contributions??e.contributions,preferences:t.preferences??e.preferences??m(),auditLog:t.auditLog??e.auditLog}))}function d(t){l.setState(e=>({auditLog:[t,...e.auditLog].slice(0,50)}))}function N(t,e){const o=URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download=e,a.click(),URL.revokeObjectURL(o)}function j(){const t=y(),e=JSON.stringify(t,null,2),o=new Blob([e],{type:"application/json"}),a=`budget-dashboard-backup-${new Date().toISOString()}.json`;d({id:crypto.randomUUID(),action:"export",details:{},timestamp:new Date().toISOString()}),N(o,a)}function w(t){try{const e=JSON.parse(t);return S(e),d({id:crypto.randomUUID(),action:"import",details:{counts:{transactions:e.transactions.length,categories:e.categories.length,goals:e.goals.length,contributions:e.contributions.length}},timestamp:new Date().toISOString()}),{status:"success"}}catch(e){return console.error("Import failed",e),d({id:crypto.randomUUID(),action:"import",details:{error:e instanceof Error?e.message:"unknown"},timestamp:new Date().toISOString()}),{status:"failed"}}}function D(){const[t,e]=c.useState(null),[o,a]=c.useState(null),[x,g]=c.useState(!0),[p,u]=c.useState(""),i=l(r=>r.preferences),h=()=>{a(null),e("Preparing JSON export...");try{j(),e("Export downloaded successfully.")}catch(r){console.error(r),a("Export failed. Please try again.")}},b=r=>{r.preventDefault(),a(null),e("Importing data...");try{w(p).status==="success"?(e("Import completed. Reload the dashboard to see updates."),u("")):a("Import failed. Check file contents and try again.")}catch(n){console.error(n),a("Import failed. Check file contents and try again.")}},f=r=>{const n=r.target.checked;g(n),document.body.classList.toggle("light",!n)};return s.jsxs("section",{className:"space-y-8",children:[s.jsxs("header",{className:"space-y-2",children:[s.jsx("h2",{className:"text-3xl font-semibold text-slate-50",children:"Settings & Data Safety"}),s.jsx("p",{className:"max-w-2xl text-sm text-slate-400",children:"Configure dashboard preferences, export backups, and import saved budgets. Data stays on this device unless you explicitly export it."})]}),s.jsxs("section",{className:"rounded-2xl border border-slate-800/70 bg-slate-900/40 p-6",children:[s.jsx("h3",{className:"text-sm font-semibold uppercase tracking-widest text-slate-400",children:"Appearance"}),s.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 text-sm text-slate-200",children:[s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:x,onChange:f}),"Follow system theme automatically"]}),s.jsxs("span",{className:"text-xs text-slate-500",children:["Current preference: ",(i==null?void 0:i.theme)??"system"]})]})]}),s.jsxs("section",{className:"grid gap-6 lg:grid-cols-2",children:[s.jsxs("div",{className:"space-y-4 rounded-2xl border border-slate-800/70 bg-slate-900/40 p-6",children:[s.jsx("h3",{className:"text-sm font-semibold uppercase tracking-widest text-slate-400",children:"Export Data"}),s.jsx("p",{className:"text-sm text-slate-300",children:"Download a JSON file containing transactions, goals, categories, contributions, preferences, and audit history. Keep this file safe for manual backups."}),s.jsx("button",{type:"button",onClick:h,className:"rounded-lg bg-brand-primary px-4 py-2 text-sm font-semibold text-white shadow shadow-brand-primary/40",children:"Export JSON backup"})]}),s.jsxs("form",{onSubmit:b,className:"space-y-4 rounded-2xl border border-slate-800/70 bg-slate-900/40 p-6",children:[s.jsx("h3",{className:"text-sm font-semibold uppercase tracking-widest text-slate-400",children:"Import Data"}),s.jsx("p",{className:"text-sm text-slate-300",children:"Paste a previously exported JSON payload to restore your dashboard. Import replaces existing data; be sure you exported a backup first."}),s.jsx("textarea",{value:p,onChange:r=>u(r.target.value),placeholder:"Paste JSON export here",className:"min-h-[160px] w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-slate-100 focus:border-brand-primary focus:outline-none",required:!0}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"submit",className:"rounded-lg bg-brand-secondary px-4 py-2 text-sm font-semibold text-white shadow shadow-brand-secondary/40",children:"Import JSON backup"})})]})]}),(t||o)&&s.jsx("div",{className:`rounded-xl border px-4 py-3 text-sm ${o?"border-rose-500/40 bg-rose-500/10 text-rose-100":"border-emerald-500/40 bg-emerald-500/10 text-emerald-100"}`,children:o??t})]})}export{D as default};
